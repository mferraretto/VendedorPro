<div class="max-w-6xl mx-auto">
  <div class="flex flex-wrap items-center gap-2">
    <button
      type="button"
      class="btn btn-secondary vts-subtab-btn active"
      data-vts-subtab="etiquetas"
    >
      <i class="fas fa-tags mr-2"></i>
      Etiquetas
    </button>
    <button
      type="button"
      class="btn btn-secondary vts-subtab-btn"
      data-vts-subtab="associacoes"
    >
      <i class="fas fa-link mr-2"></i>
      Associar SKU
    </button>
    <button
      type="button"
      class="btn btn-secondary vts-subtab-btn"
      data-vts-subtab="resumo"
    >
      <i class="fas fa-chart-column mr-2"></i>
      Resumo mensal
    </button>
  </div>
</div>

<div id="vtsSubtabEtiquetas" data-vts-subtab-panel="etiquetas" class="space-y-6 mt-6">
  <div class="card max-w-5xl mx-auto">
  <div class="card-header flex items-center gap-3">
    <i class="fas fa-qrcode text-indigo-600"></i>
    <div>
      <h3 class="text-xl font-semibold text-slate-800">VTS • Importação de Etiquetas</h3>
      <p class="text-sm text-slate-500">
        Importe PDFs de etiquetas para registrar automaticamente SKU, número do pedido, código de rastreio,
        loja e data no acompanhamento dos usuários.
      </p>
    </div>
  </div>
  <div class="card-body space-y-6">
    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      <div class="space-y-3 rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm">
        <div class="flex items-center justify-between gap-2">
          <h4 class="text-sm font-semibold text-slate-700 uppercase tracking-wide">Mercado Livre</h4>
          <span class="inline-flex items-center rounded-full bg-indigo-100 px-2.5 py-0.5 text-xs font-medium text-indigo-700">PDF</span>
        </div>
        <label for="vtsPdfInput" class="block text-xs font-medium text-slate-600">Arquivo de etiquetas Mercado Livre</label>
        <input
          type="file"
          id="vtsPdfInput"
          accept="application/pdf"
          class="form-control"
        />
        <p class="text-[11px] leading-relaxed text-slate-500">
          Utilize o PDF gerado pelo Mercado Livre. O leitor identifica SKU, pedido, rastreio, data e loja automaticamente.
        </p>
        <button
          id="vtsProcessarBtn"
          class="btn btn-primary w-full justify-center"
          type="button"
        >
          <i class="fas fa-file-import mr-2"></i>
          Processar etiquetas Mercado Livre
        </button>
      </div>

      <div class="space-y-3 rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm">
        <div class="flex items-center justify-between gap-2">
          <h4 class="text-sm font-semibold text-slate-700 uppercase tracking-wide">Shopee</h4>
          <span class="inline-flex items-center rounded-full bg-orange-100 px-2.5 py-0.5 text-xs font-medium text-orange-700">PDF</span>
        </div>
        <label for="vtsPdfInputShopee" class="block text-xs font-medium text-slate-600">Arquivo de etiquetas Shopee</label>
        <input
          type="file"
          id="vtsPdfInputShopee"
          accept="application/pdf"
          class="form-control"
        />
        <p class="text-[11px] leading-relaxed text-slate-500">
          Faça o upload do PDF exportado na Shopee. O sistema extrai SKU, pedido, rastreio, data e loja do documento.
        </p>
        <button
          id="vtsProcessarBtnShopee"
          class="btn btn-primary w-full justify-center"
          type="button"
        >
          <i class="fas fa-file-import mr-2"></i>
          Processar etiquetas Shopee
        </button>
      </div>

      <div class="space-y-3 rounded-xl border border-slate-200 bg-slate-50 p-4 shadow-sm">
        <div class="flex items-center justify-between gap-2">
          <h4 class="text-sm font-semibold text-slate-700 uppercase tracking-wide">Magalu</h4>
          <span class="inline-flex items-center rounded-full bg-sky-100 px-2.5 py-0.5 text-xs font-medium text-sky-700">PDF</span>
        </div>
        <label for="vtsPdfInputMagalu" class="block text-xs font-medium text-slate-600">Arquivo de etiquetas Magalu</label>
        <input
          type="file"
          id="vtsPdfInputMagalu"
          accept="application/pdf"
          class="form-control"
        />
        <p class="text-[11px] leading-relaxed text-slate-500">
          Envie o PDF de etiquetas emitido pela Magalu. Vamos localizar SKU, pedido, rastreio, data e loja.
        </p>
        <button
          id="vtsProcessarBtnMagalu"
          class="btn btn-primary w-full justify-center"
          type="button"
        >
          <i class="fas fa-file-import mr-2"></i>
          Processar etiquetas Magalu
        </button>
      </div>
    </div>
    <div
      id="vtsLoading"
      class="hidden items-center gap-2 text-sm text-slate-500"
    >
      <i class="fas fa-circle-notch fa-spin"></i>
      Processando etiquetas, aguarde...
    </div>
    <div
      id="vtsFeedback"
      class="mt-3 rounded-lg px-4 py-3 text-sm font-medium hidden"
    ></div>
  </div>
</div>
<div class="card max-w-5xl mx-auto mt-6">
  <div class="card-header flex items-center gap-3">
    <i class="fas fa-keyboard text-emerald-600"></i>
    <div>
      <h3 class="text-lg font-semibold text-slate-800">Entrada manual de etiqueta</h3>
      <p class="text-sm text-slate-500">
        Registre manualmente uma etiqueta quando não for possível processar o PDF. Informe pelo menos o número
        do pedido ou o código de rastreio para localizar o registro futuramente.
      </p>
    </div>
  </div>
  <div class="card-body">
    <form id="vtsEntradaManualForm" class="grid gap-4 md:grid-cols-2">
      <div>
        <label for="vtsManualSku" class="block text-xs font-medium text-slate-600">SKU</label>
        <input
          type="text"
          id="vtsManualSku"
          class="form-control"
          placeholder="Informe o SKU (opcional)"
          autocomplete="off"
        />
      </div>
      <div>
        <label for="vtsManualPedido" class="block text-xs font-medium text-slate-600">Número do pedido</label>
        <input
          type="text"
          id="vtsManualPedido"
          class="form-control"
          placeholder="Obrigatório se não informar o rastreio"
          autocomplete="off"
        />
      </div>
      <div>
        <label for="vtsManualRastreio" class="block text-xs font-medium text-slate-600">Código de rastreio</label>
        <input
          type="text"
          id="vtsManualRastreio"
          class="form-control"
          placeholder="Obrigatório se não informar o pedido"
          autocomplete="off"
        />
      </div>
      <div>
        <label for="vtsManualLoja" class="block text-xs font-medium text-slate-600">Loja</label>
        <input
          type="text"
          id="vtsManualLoja"
          class="form-control"
          placeholder="Ex.: Shopee"
          list="vtsManualLojas"
          autocomplete="off"
        />
        <datalist id="vtsManualLojas"></datalist>
      </div>
      <div>
        <label for="vtsManualData" class="block text-xs font-medium text-slate-600">Data da etiqueta</label>
        <input type="date" id="vtsManualData" class="form-control" />
      </div>
      <div>
        <label for="vtsManualBuyer" class="block text-xs font-medium text-slate-600">Usuário/comprador</label>
        <input
          type="text"
          id="vtsManualBuyer"
          class="form-control"
          placeholder="Nome do comprador (opcional)"
          autocomplete="off"
        />
      </div>
      <div class="md:col-span-2 flex justify-end">
        <button type="submit" id="vtsEntradaManualSubmit" class="btn btn-success">
          <i class="fas fa-save mr-2"></i>
          Registrar etiqueta manualmente
        </button>
      </div>
    </form>
    <p class="mt-3 text-xs text-slate-400">
      Sempre que possível, utilize o processamento automático via PDF para evitar duplicidades. A entrada
      manual registra as mesmas informações e fica disponível na lista de etiquetas importadas.
    </p>
  </div>
</div>
<div class="card max-w-5xl mx-auto mt-6">
  <div class="card-header">
    <h3 class="text-lg font-semibold text-slate-800">Devoluções e cancelamentos</h3>
    <p class="text-sm text-slate-500">
      Informe o número do pedido <strong>ou</strong> o código de rastreio e a loja correspondente. O pedido
      localizado será destacado como cancelado na lista de etiquetas importadas.
    </p>
  </div>
  <div class="card-body">
    <form id="vtsDevolucaoForm" class="grid gap-4 md:grid-cols-2 lg:grid-cols-5">
      <div class="md:col-span-2">
        <label for="vtsDevolucaoPedido" class="block text-xs font-medium text-slate-600">Número do pedido</label>
        <input
          type="text"
          id="vtsDevolucaoPedido"
          class="form-control"
          placeholder="Informe o pedido (opcional)"
          autocomplete="off"
        />
      </div>
      <div class="md:col-span-2">
        <label for="vtsDevolucaoRastreio" class="block text-xs font-medium text-slate-600">Código de rastreio</label>
        <input
          type="text"
          id="vtsDevolucaoRastreio"
          class="form-control"
          placeholder="Informe o rastreio (opcional)"
          autocomplete="off"
        />
      </div>
      <div class="md:col-span-2 lg:col-span-1">
        <label for="vtsDevolucaoLoja" class="block text-xs font-medium text-slate-600">Loja</label>
        <input
          type="text"
          id="vtsDevolucaoLoja"
          class="form-control"
          placeholder="Ex.: Shopee"
          list="vtsDevolucaoLojas"
          autocomplete="off"
          required
        />
        <datalist id="vtsDevolucaoLojas"></datalist>
      </div>
      <div class="md:col-span-2 lg:col-span-1 flex items-end">
        <button
          type="submit"
          id="vtsDevolucaoSubmit"
          class="btn btn-warning w-full justify-center"
        >
          <i class="fas fa-undo-alt mr-2"></i>
          Registrar devolução
        </button>
      </div>
    </form>
    <p class="mt-3 text-xs text-slate-400">
      Utilize este recurso para sinalizar devoluções e cancelamentos. Os pedidos marcados ficarão destacados em vermelho.
    </p>
  </div>
</div>
  <div class="card max-w-6xl mx-auto mt-8">
  <div class="card-header flex flex-wrap items-center justify-between gap-2">
    <div>
      <h3 class="text-lg font-semibold text-slate-800">Etiquetas importadas</h3>
      <p id="vtsResumo" class="text-sm text-slate-500">Carregando registros...</p>
    </div>
    <div class="flex flex-wrap items-center gap-2">
      <button
        id="vtsExportarExcel"
        type="button"
        class="btn btn-secondary flex items-center gap-2"
      >
        <i class="fas fa-file-export"></i>
        <span>Exportar Excel</span>
      </button>
      <label
        class="relative btn btn-secondary flex items-center gap-2 cursor-pointer"
      >
        <i class="fas fa-file-import"></i>
        <span>Importar planilha</span>
        <input
          id="vtsImportarExcel"
          type="file"
          accept=".xlsx,.xls"
          class="absolute inset-0 h-full w-full cursor-pointer opacity-0"
        />
      </label>
    </div>
  </div>
  <div class="card-body p-0">
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm">
        <thead class="bg-slate-100 text-slate-600 uppercase text-xs">
          <tr>
            <th class="px-4 py-3 text-left font-semibold">SKU</th>
            <th class="px-4 py-3 text-left font-semibold">Número do pedido</th>
            <th class="px-4 py-3 text-left font-semibold">Rastreio</th>
            <th class="px-4 py-3 text-left font-semibold">Loja</th>
            <th class="px-4 py-3 text-left font-semibold">Data</th>
            <th class="px-4 py-3 text-left font-semibold">Arquivo</th>
            <th class="px-4 py-3 text-left font-semibold">Status</th>
            <th class="px-4 py-3 text-left font-semibold">Ações</th>
          </tr>
        </thead>
        <tbody id="vtsTabelaCorpo" class="bg-white"></tbody>
      </table>
    </div>
    <p class="px-4 pb-4 pt-3 text-xs text-slate-400">
      Utilize o botão de exportação para gerar o modelo da planilha. Somente arquivos no mesmo formato
      são aceitos na importação.
    </p>
  </div>
</div>
  <div class="card max-w-6xl mx-auto mt-6">
    <div class="card-header flex flex-wrap items-center justify-between gap-2">
      <div>
        <h3 class="text-lg font-semibold text-slate-800">Diagnóstico da leitura do PDF</h3>
        <p class="text-sm text-slate-500">
          Visualize exatamente o texto identificado em cada página e como o sistema interpretou as etiquetas.
        </p>
      </div>
      <button
        id="vtsToggleDebug"
        type="button"
        class="btn btn-secondary whitespace-nowrap"
      >
        Mostrar diagnóstico
      </button>
    </div>
    <div id="vtsDebugContainer" class="card-body hidden">
      <div class="space-y-3">
        <p id="vtsDebugResumo" class="text-sm text-slate-600"></p>
        <pre
          id="vtsDebugPre"
          class="bg-slate-900 text-slate-50 text-xs rounded-lg p-4 overflow-auto max-h-96"
        ></pre>
      </div>
    </div>
  </div>

</div>

<div
  id="vtsSubtabAssociacoes"
  data-vts-subtab-panel="associacoes"
  class="space-y-6 mt-6 hidden"
>
  <div class="card max-w-4xl mx-auto">
    <div class="card-header">
      <h3 class="text-lg font-semibold text-slate-800">Associar SKUs</h3>
      <p class="text-sm text-slate-500">
        Defina um SKU principal e inclua variações ou códigos equivalentes para consolidar a análise do resumo mensal.
      </p>
    </div>
    <div class="card-body space-y-4">
      <form id="vtsSkuForm" class="grid gap-4 md:grid-cols-2">
        <div class="md:col-span-2">
          <label for="vtsSkuPrincipal" class="block text-xs font-medium text-slate-600">SKU principal</label>
          <input
            type="text"
            id="vtsSkuPrincipal"
            class="form-control"
            placeholder="Informe o SKU principal"
            autocomplete="off"
            required
          />
        </div>
        <div class="md:col-span-2">
          <label for="vtsSkuAssociados" class="block text-xs font-medium text-slate-600">SKUs associados</label>
          <textarea
            id="vtsSkuAssociados"
            class="form-control"
            rows="3"
            placeholder="Informe os SKUs relacionados separados por vírgula ou linha"
          ></textarea>
          <p class="mt-1 text-[11px] leading-relaxed text-slate-500">
            Utilize esta lista para adicionar códigos que representam o mesmo produto (por exemplo, variações de cor ou embalagem).
          </p>
        </div>
        <div>
          <label for="vtsSkuSobraEsperada" class="block text-xs font-medium text-slate-600">Sobra esperada</label>
          <input
            type="number"
            id="vtsSkuSobraEsperada"
            class="form-control"
            placeholder="Quantidade prevista"
            step="0.01"
            min="0"
          />
          <p class="mt-1 text-[11px] leading-relaxed text-slate-500">
            Informe a quantidade prevista de sobra para o SKU principal. Este valor será exibido no resumo mensal.
          </p>
        </div>
        <div class="flex items-center gap-3 md:col-span-2">
          <button type="submit" class="btn btn-primary" id="vtsSkuSalvar">
            <i class="fas fa-save mr-2"></i>
            Salvar associação
          </button>
          <button type="button" class="btn btn-secondary hidden" id="vtsSkuCancelar">
            <i class="fas fa-xmark mr-2"></i>
            Cancelar edição
          </button>
        </div>
      </form>
      <div id="vtsSkuFeedback" class="hidden"></div>
    </div>
  </div>

  <div class="card max-w-5xl mx-auto">
    <div class="card-header flex items-center justify-between gap-2">
      <div>
        <h3 class="text-lg font-semibold text-slate-800">SKUs associados</h3>
        <p class="text-sm text-slate-500">Gerencie os SKUs já cadastrados. É possível editar ou excluir quando necessário.</p>
      </div>
    </div>
    <div class="card-body p-0">
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm">
          <thead class="bg-slate-100 text-slate-600 uppercase text-xs">
            <tr>
              <th class="px-4 py-3 text-left font-semibold">SKU principal</th>
              <th class="px-4 py-3 text-left font-semibold">Associados</th>
              <th class="px-4 py-3 text-right font-semibold">Sobra esperada</th>
              <th class="px-4 py-3 text-left font-semibold">Ações</th>
            </tr>
          </thead>
          <tbody id="vtsSkuTabelaCorpo" class="bg-white"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div
  id="vtsSubtabResumo"
  data-vts-subtab-panel="resumo"
  class="space-y-6 mt-6 hidden"
>
  <div class="card max-w-5xl mx-auto">
    <div class="card-header flex flex-wrap items-center justify-between gap-3">
      <div>
        <h3 class="text-lg font-semibold text-slate-800">Resumo mensal por SKU</h3>
        <p class="text-sm text-slate-500">
          O resumo consolida as etiquetas importadas agrupando por SKU principal e seus associados.
        </p>
      </div>
      <div class="flex items-center gap-2">
        <label for="vtsResumoMes" class="text-xs font-medium text-slate-600 uppercase tracking-wide">Mês de referência</label>
        <input type="month" id="vtsResumoMes" class="form-control w-36" />
      </div>
    </div>
    <div class="card-body space-y-4">
      <div id="vtsResumoFeedback" class="hidden"></div>
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm">
          <thead class="bg-slate-100 text-slate-600 uppercase text-xs">
            <tr>
              <th class="px-4 py-3 text-left font-semibold">SKU principal</th>
              <th class="px-4 py-3 text-left font-semibold">SKUs considerados</th>
              <th class="px-4 py-3 text-right font-semibold">Sobra esperada</th>
              <th class="px-4 py-3 text-right font-semibold">Total vendido</th>
              <th class="px-4 py-3 text-right font-semibold">Total cancelado</th>
            </tr>
          </thead>
          <tbody id="vtsResumoTabelaCorpo" class="bg-white"></tbody>
        </table>
      </div>
      <div class="rounded-lg border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-600">
        <p>
          <strong>Total vendido no período:</strong>
          <span id="vtsResumoTotalVendido" class="font-semibold text-slate-800">0</span>
        </p>
        <p class="mt-1">
          <strong>Total cancelado no período:</strong>
          <span id="vtsResumoTotalCancelado" class="font-semibold text-slate-800">0</span>
        </p>
        <p class="mt-1">
          <strong>Total esperado sinalizado:</strong>
          <span id="vtsResumoTotalEsperado" class="font-semibold text-slate-800">0</span>
        </p>
      </div>
    </div>
  </div>
</div>
